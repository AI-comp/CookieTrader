<!DOCTYPE HTML>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="socket.io/socket.io.js" type="text/javascript"></script>
    <title>CookieTrader</title>

    <script>
    // WebSocketサーバに接続
    var socket = io.connect('http://localhost:5000/');

    socket.on('connect', function(){
      console.log('connect!')
    });
    
    socket.on('disconnect', function(){
      console.log("disconnect from server");
    });
    
    // メッセージ受信イベントを処理
    socket.on('message', function(from, msg) {
      alert('Received.');
    });

    socket.on('purchase', function(from,msg) {
      alert('Purchased ' + msg);
    });
  
    $(function() {
      $('p').click(function() {
        $(this).fadeOut('slow');
      });
    });
    
    function check1() {
      alert($("#text").val());
      socket.emit("message", $("#text").val());
    }

    function purchase(itemName) {
      count = cookie.count;
      alert(count);
      socket.emit("purchase", {item: itemName, cookie: 1000});
    }
    </script>
  </head>
  <body>
    <h1><%= message %></h1>

    <p>おばけー（クリックしよう！）</p>
    <input type="text" id="text" value="" size="20">
    <input type="button" onclick="check1();" value="Send">

    <input type="button" onclick="purchase('Cursor');" value="Buy Cursor">
    <input type="button" onclick="purchase('Grandma');" value="Buy Grandma">
    <input type="button" onclick="purchase('Farm');" value="Buy Farm">
    <input type="button" onclick="purchase('Factory');" value="Buy Factory">
    <input type="button" onclick="purchase('Mine');" value="Buy Mine">
    <input type="button" onclick="purchase('Shipment');" value="Buy Shipment">
    <input type="button" onclick="purchase('AlchemyLab');" value="Buy AlchemyLab">
    <input type="button" onclick="purchase('Portal');" value="Buy Portal">
    <input type="button" onclick="purchase('TimeMachine');" value="Buy TimeMachine">
    <input type="button" onclick="purchase('AntimatterCondenser');" value="Buy AntimatterCondenser">
    
    <script>
      // アルファベットをランダムに10個表示
      var message = "";
      var alphabet = "qwertyuiopasdfghjklzxcvbnm";
      var size = alphabet.length
      for(var i = 0; i < 10; i++) {
        message += alphabet.charAt((Math.random() * size) % size);
      }
      document.write(message);
    </script>
    
  </body>
</html>
